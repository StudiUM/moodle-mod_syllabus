{"version":3,"sources":["../src/syllabusform.js"],"names":["define","$","str","notification","requiredfieldspopup","SyllabusForm","configdatepicker","configmanageline","fieldfortypeofsubmit","tabsinit","managelines","onclickbuttons","prototype","nbrepeat","self","each","index","value","identifier","parseInt","name","val","reorderlines","on","event","preventDefault","data","repeatname","element","get_strings","key","component","done","strings","confirm","linetodelete","closest","remove","removeClass","fail","exception","hiddenBlock","clone","addClass","insertBefore","attr","newname","replace","toString","Y","use","M","form","dateselector","init_date_selectors","id","namerepeat","find","collapseall","expandall","tabid","hasClass","text","toggleClass","trigger","id_fieldset","allcollapsed","allexpanded","linkcollapseallexpandall","keysubmit","fieldsubmit","tabserror","field","fieldtovalidate","valuetovalidate","editorid","length","contents","trim","tabname","parents","inArray","push","target","init","tempunload","window","onbeforeunload","submit"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for the syllabus form class.\n *\n * @module    mod_syllabus/syllabusform\n * @copyright 2019 Université de Montréal\n * @author    Issam Taboubi <issam.taboubi@umontreal.ca>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/str', 'core/notification', 'mod_syllabus/requiredfields_popup'],\n    function ($, str, notification, requiredfieldspopup) {\n\n        /**\n         * Syllabus form.\n         * @param {Array} configdatepicker\n         * @param {Array} configmanageline\n         * @param {string} fieldfortypeofsubmit\n         */\n        var SyllabusForm = function (configdatepicker, configmanageline, fieldfortypeofsubmit) {\n            this.configdatepicker = configdatepicker;\n            this.configmanageline = configmanageline;\n            this.fieldfortypeofsubmit = fieldfortypeofsubmit;\n\n            // Init tabs form.\n            this.tabsinit();\n\n            // Set calendar behaviour.\n            this.managelines();\n\n            // Init the onclickbuttons function.\n            this.onclickbuttons();\n        };\n\n        /** @var {Array} The nb repeats array. */\n        SyllabusForm.prototype.nbrepeat = [];\n\n        /** @var {Array} The datepicker config. */\n        SyllabusForm.prototype.configdatepicker = [];\n\n        /** @var {Array} The manageline config. */\n        SyllabusForm.prototype.configmanageline = [];\n\n        /** @var {RequiredfieldsPopup} The instance of RequiredfieldsPopup (the popup to show the list of tabs with errors). */\n        SyllabusForm.prototype.requiredfieldspopup = null;\n\n        /** @var {string} The name of the field to identify the type of submit (which submit button was clicked). */\n        SyllabusForm.prototype.fieldfortypeofsubmit = '';\n\n        /**\n         * Manages lines set up.\n         *\n         * @name   managelines\n         * @return {Void}\n         * @function\n         */\n        SyllabusForm.prototype.managelines = function () {\n            var self = this;\n            $.each(this.configmanageline, function( index, value ) {\n                self.nbrepeat[value.identifier] = parseInt($('input[name=\"' + value.name + '\"]').val());\n                self.reorderlines(value.identifier, value.name);\n            });\n\n            // Handle on delete click.\n            $(\"#page-mod-syllabus-edit\").on('click', 'a.deleteline', function(event) {\n                event.preventDefault();\n\n                var identifier = $(this).data('id');\n                var repeatname = $(this).data('repeat');\n                var element = $(this);\n                str.get_strings([\n                    {key: 'confirm', component: 'moodle'},\n                    {key: 'confirmdeleteline', component: 'mod_syllabus'},\n                    {key: 'delete', component: 'moodle'},\n                    {key: 'cancel', component: 'moodle'}\n                ]).done(function(strings) {\n                    notification.confirm(\n                        strings[0],\n                        strings[1],\n                        strings[2],\n                        strings[3],\n                        function() {\n                            var linetodelete = element.closest('.syllabus_repeated_item');\n                            linetodelete.remove();\n                            self.nbrepeat[identifier]--;\n                            // Remove css border if no more item in calendar.\n                            if (!self.nbrepeat[identifier]) {\n                                $('#' + identifier + '.syllabus_repeated_items_block').removeClass(\"greyborder\");\n                            }\n                            self.reorderlines(identifier, repeatname);\n                        }\n                    );\n                }).fail(notification.exception);\n            });\n            // Handle on add click.\n            $(\"#page-mod-syllabus-edit\").on('click', '.addline', function(event) {\n                event.preventDefault();\n\n                var identifier = $(this).data('id');\n                var repeatname = $(this).data('repeat');\n                var hiddenBlock = $(\"#\" + identifier + \" .hidden\");\n\n                hiddenBlock.clone().addClass('newline').insertBefore(\"#\" + identifier + \" .hidden\");\n                $(\"#\" + identifier + \" .newline [name^='\" + identifier + \"_']\").each(function() {\n                    var name = $(this).attr('name');\n                    var patt = /newindex/g;\n                    var index = self.nbrepeat[identifier] + 1;\n                    var newname = name.replace(patt, index.toString());\n                    $(this).attr('name', newname);\n                });\n                $('.newline').removeClass('newline hidden');\n                // Add css border if calendar was empty.\n                if (!self.nbrepeat[identifier]) {\n                    $('#' + identifier + '.syllabus_repeated_items_block').addClass(\"greyborder\");\n                }\n                self.nbrepeat[identifier]++;\n                self.reorderlines(identifier, repeatname);\n                // Re-apply datepicker.\n                Y.use(\"moodle-form-dateselector\",function() {\n                    M.form.dateselector.init_date_selectors(self.configdatepicker);\n                });\n            });\n        };\n\n        /**\n         * Reorder lines.\n         *\n         * @name   reorderlines\n         * @param {String} id\n         * @param {String} namerepeat\n         * @return {Void}\n         * @function\n         */\n        SyllabusForm.prototype.reorderlines = function (id, namerepeat) {\n            var self = this;\n            $(\"#\" + id + \" .syllabus_repeated_item:not(.hidden)\").each(function(index) {\n                $(this).find(\"[name^='\" + id + \"_']\").each(function() {\n                    var name = $(this).attr('name');\n                    var patt = /\\[[0-9]+\\]/g;\n                    var newname = name.replace(patt, '[' + index.toString() + ']');\n                    $(this).attr('name', newname);\n                });\n            });\n            $('input[name=\"' + namerepeat + '\"]').val(self.nbrepeat[id]);\n        };\n\n        /**\n         * Syllabus tabs form.\n         *\n         * @name   tabsinit\n         * @return {Void}\n         * @function\n         */\n        SyllabusForm.prototype.tabsinit = function () {\n            str.get_strings([\n                {key: 'collapseall'},\n                {key: 'expandall'}]\n                    ).done(\n                    function (strings) {\n                        var collapseall = strings[0];\n                        var expandall = strings[1];\n                        // Collapse/Expand all.\n                        $(\".syllabus\").on('click', '.collapsible-actions a', function (event) {\n                            event.preventDefault();\n                            var tabid = $(this).closest('div.tab-pane').attr('id');\n                            if ($(this).hasClass('collapse-all')) {\n                                $(this).text(expandall);\n                                $(this).toggleClass(\"collapse-all expand-all\");\n                                $('.syllabus #' + tabid + ' fieldset.collapsible:not(.collapsed) a.fheader').trigger('click');\n                            } else {\n                                $(this).text(collapseall);\n                                $(this).toggleClass(\"collapse-all expand-all\");\n                                $('.syllabus #' + tabid + ' fieldset.collapsible.collapsed a.fheader').trigger('click');\n                            }\n                        });\n\n                        $(\".syllabus\").on('click', 'ul.nav-tabs li.nav-item a', function (event) {\n                            event.preventDefault();\n                            var tabid = $(this).data('tab');\n                            $('input[name=\"rubric\"]').val(tabid);\n                        });\n\n                        // Single collapse/expand.\n                        $('.syllabus legend a.fheader').on('click', function (event) {\n                            event.preventDefault();\n                            var id_fieldset = $(this).attr('aria-controls');\n                            var tabid = $(this).closest('div.tab-pane').attr('id');\n\n                            $('#' + id_fieldset).toggleClass('collapsed');\n\n                            if ($('#' + id_fieldset).hasClass('collapsed')) {\n                                $(this).attr('aria-expanded', false);\n                            } else {\n                                $(this).attr('aria-expanded', true);\n                            }\n\n                            var allcollapsed = true;\n                            var allexpanded = true;\n                            $('.syllabus #' + tabid + ' fieldset.collapsible').each(function () {\n                                allcollapsed = $(this).hasClass('collapsed') && allcollapsed;\n                                allexpanded = !$(this).hasClass('collapsed') && allexpanded;\n                            });\n                            var linkcollapseallexpandall = $('.syllabus #' + tabid + ' .collapsible-actions a');\n                            if (linkcollapseallexpandall.hasClass('collapse-all') &&\n                                    allcollapsed) {\n                                linkcollapseallexpandall.text(expandall);\n                                linkcollapseallexpandall.toggleClass(\"collapse-all expand-all\");\n                            } else if (linkcollapseallexpandall.hasClass('expand-all') &&\n                                    allexpanded) {\n                                linkcollapseallexpandall.text(collapseall);\n                                linkcollapseallexpandall.toggleClass(\"collapse-all expand-all\");\n                            }\n                        });\n                    }\n            ).fail(notification.exception);\n        };\n\n        /**\n         * Initialises the actions execute when one of the form submit buttons is clicked.\n         *\n         * @name   onclickbuttons\n         * @return {Void}\n         * @function\n         */\n        SyllabusForm.prototype.onclickbuttons = function () {\n            var self = this;\n\n            // For each submit button.\n            $('#page-mod-syllabus-edit [data-submitbtn=\"true\"]').each(function(keysubmit, fieldsubmit) {\n                $(fieldsubmit).on('click', function(event) {\n                    event.preventDefault();\n                    var tabserror = [];\n                    // For each required field in the form.\n                    $('[data-required=\"true\"]').each(function(key, field) {\n                        // Do not check hidden rows used for duplication.\n                        if (!$(this).closest('.syllabus_repeated_item').hasClass('hidden')) {\n                            // For regular fields.\n                            var fieldtovalidate = field;\n                            var valuetovalidate = $(field).val();\n\n                            if ($(fieldtovalidate).data('editorfield')) {\n                                // For fields with rich text editor.\n                                var editorid = '#id_' + $(fieldtovalidate).data('editorfield');\n                                if ($(editorid + 'editable').length) {\n                                    // If the field with 'editable' suffix exists, use this field instead of the regular fields.\n                                    // This is used for the Atto editor only.\n                                    fieldtovalidate = editorid + 'editable';\n                                    valuetovalidate = $(editorid + 'editable').text();\n                                } else if($(editorid + '_parent').length) {\n                                    // If the field with '_parent' suffix exists, use this field instead of the regular fields.\n                                    // This is used for the TinyMce editor only.\n                                    fieldtovalidate = editorid + '_parent .mceIframeContainer';\n                                    valuetovalidate = $(editorid + '_ifr').contents().find('body').text();\n                                } else {\n                                    // This is used for the Plain text area editor.\n                                    fieldtovalidate = editorid;\n                                    valuetovalidate = $(fieldtovalidate).val();\n                                }\n                            }\n\n                            // If the field is empty.\n                            if (valuetovalidate.trim() == '') {\n                                // Show the field as invalid.\n                                $(fieldtovalidate).addClass('is-invalid');\n\n                                // Save the name of the tab for this field.\n                                var tabname = $(field).parents('[role=\"tabpanel\"]').data('tabname');\n                                if ($.inArray(tabname, tabserror) == -1) {\n                                    tabserror.push( tabname );\n                                }\n                            } else {\n                                // The field is valid, make sure it is not shown as invalid anymore.\n                                $(fieldtovalidate).removeClass('is-invalid');\n                            }\n                        }\n                    });\n\n                    // Some duplicable rubrics must be added at least once.\n                    $('[data-morethanone=\"true\"]').each(function(key, field) {\n                        if ($(field).val() < 1) {\n                            $('[data-repeat=\"' + $(field).attr('name') + '\"]').addClass('is-invalid');\n                            var tabname = $(field).data('tabname');\n                            if ($.inArray(tabname, tabserror) == -1) {\n                                tabserror.push( tabname );\n                            }\n                        } else {\n                            $('[data-repeat=\"' + $(field).attr('name') + '\"]').removeClass('is-invalid');\n                        }\n                    });\n\n                    // Keep which button was clicked.\n                    $('#page-mod-syllabus-edit [name=' + self.fieldfortypeofsubmit + ']').val(event.target.name);\n                    if (tabserror.length > 0) {\n                        // Show the error popup.\n                        requiredfieldspopup.init(tabserror, $(this).parents('form'));\n                    } else {\n                        // Submit the form.\n                        // Temporarily set onbeforeunload to null to avoid the browser popup saying the changes were not saved.\n                        var tempunload = window.onbeforeunload;\n                        window.onbeforeunload = null;\n                        // Call the old onbeforeunload function in case some usefull stuff is done in it.\n                        tempunload();\n                        // Submit the form and set back the old onbeforeunload.\n                        $(this).parents('form').submit();\n                        window.onbeforeunload = tempunload;\n                    }\n                });\n            });\n        };\n\n        return  {\n            init: function (configdatepicker, configmanageline, fieldfortypeofsubmit) {\n                new SyllabusForm(configdatepicker, configmanageline, fieldfortypeofsubmit);\n            }\n        };\n    });"],"file":"syllabusform.min.js"}